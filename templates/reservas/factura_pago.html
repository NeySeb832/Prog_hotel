<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>{{ payment.invoice_number }} · {{ hotel_nombre }}</title>
  <style>
    body {
      font-family: DejaVu Sans, Arial, sans-serif;
      font-size: 12px;
      color: #111827;
    }
    .header, .footer {
      width: 100%;
    }
    .header td {
      vertical-align: top;
    }
    .title {
      font-size: 20px;
      font-weight: bold;
      text-transform: uppercase;
    }
    .muted {
      color: #6b7280;
    }
    .table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    .table th, .table td {
      border: 1px solid #e5e7eb;
      padding: 6px 8px;
    }
    .table th {
      background: #f3f4f6;
      text-align: left;
    }
    .totales {
      margin-top: 12px;
      width: 40%;
      float: right;
      border-collapse: collapse;
    }
    .totales th, .totales td {
      border: 1px solid #e5e7eb;
      padding: 6px 8px;
    }
    .totales th {
      background: #f3f4f6;
      text-align: left;
    }
    .text-right {
      text-align: right;
    }
    .mt-1 { margin-top: 4px; }
    .mt-2 { margin-top: 8px; }
    .mt-3 { margin-top: 12px; }
  </style>
</head>
<body>

  <table class="header">
    <tr>
      <td>
        <div class="title">{{ hotel_nombre }}</div>
        <div class="muted">NIT: {{ hotel_nit }}</div>
        <div class="muted">{{ hotel_direccion }}</div>
        <div class="muted">Tel: {{ hotel_telefono }}</div>
        <div class="muted">Email: {{ hotel_email }}</div>
      </td>
      <td style="text-align: right;">
        <div><strong>Factura:</strong> {{ payment.invoice_number }}</div>
        <div><strong>Fecha de emisión:</strong> {{ payment.created_at|date:"Y-m-d H:i" }}</div>
        <div><strong>Reserva:</strong> {{ reservation.code }}</div>
      </td>
    </tr>
  </table>

  <hr class="mt-2"/>

  <table style="width: 100%; margin-top: 8px;">
    <tr>
      <td style="width: 50%;">
        <strong>Datos del huésped</strong>
        <div class="mt-1">
          <div>{{ reservation.guest_name }}</div>
          {% if reservation.guest_email %}
            <div class="muted">{{ reservation.guest_email }}</div>
          {% endif %}
          {% if reservation.guest_phone %}
            <div class="muted">{{ reservation.guest_phone }}</div>
          {% endif %}
        </div>
      </td>
      <td style="width: 50%;">
        <strong>Datos de la reserva</strong>
        <div class="mt-1">
          <div><strong>Habitación:</strong> {{ reservation.room.codigo }}{% if reservation.room.tipo %} · {{ reservation.room.tipo.nombre }}{% endif %}</div>
          <div><strong>Estancia:</strong> {{ reservation.check_in }} → {{ reservation.check_out }} ({{ reservation.nights }} noche{% if reservation.nights != 1 %}s{% endif %})</div>
          <div><strong>Huéspedes:</strong> {{ reservation.adults }} adultos{% if reservation.children %}, {{ reservation.children }} niños{% endif %}</div>
        </div>
      </td>
    </tr>
  </table>

  <h3 class="mt-3">Detalle del pago</h3>

  <table class="table">
    <thead>
      <tr>
        <th>Descripción</th>
        <th class="text-right">Valor</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          Pago asociado a reserva {{ reservation.code }}<br>
          <span class="muted">
            Método: {{ payment.get_method_display }}{% if payment.reference %} · Ref: {{ payment.reference }}{% endif %}
          </span>
        </td>
        <td class="text-right">
          ${{ payment.amount }}
        </td>
      </tr>
    </tbody>
  </table>

  <table class="totales">
    <tr>
      <th>Total reserva</th>
      <td class="text-right">${{ total_reserva }}</td>
    </tr>
    <tr>
      <th>Pagado antes de este pago</th>
      <td class="text-right">${{ total_pagado_antes }}</td>
    </tr>
    <tr>
      <th>Este pago</th>
      <td class="text-right">${{ payment.amount }}</td>
    </tr>
    <tr>
      <th>Total pagado a la fecha</th>
      <td class="text-right">
        ${{ total_pagado_despues }}
      </td>
    </tr>
    <tr>
      <th>Saldo pendiente</th>
      <td class="text-right">
        ${{ saldo_pendiente }}
      </td>
    </tr>
  </table>

  <div style="clear: both;"></div>

  <div class="mt-3 muted">
    Este documento es una representación de la factura generada por el sistema de gestión del hotel.
  </div>

</body>
</html>
